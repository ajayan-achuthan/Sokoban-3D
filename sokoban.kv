#:import utils kivy.utils
ScreenManager:
    MainScreen:
    NewGameScreen:
    LevelScreen:
    GameScreen:
      
<MainScreen>:
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: 'assets/images/new_game/new_game_bg.png'
    name: 'main'
    BoxLayout:
        orientation: 'vertical'
        Button:
            text: 'New game'
            size_hint_y:  0.7
            pos_hint : {'center_x': .5, 'y': 0}
            background_normal: 'assets/images/new_game/new_game_btn.png'
            background_down: 'assets/images/new_game/new_game_btn.png'
            on_release: app.new_game(self)
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y : 0.25
            padding: [20,0]
            spacing: 20
            Button:
                text: 'Settings'
                background_normal: 'assets/images/new_game/settings.png'
                background_down: 'assets/images/new_game/settings.png'
                on_release: app.settings(self)
            Button:
                text: 'Exit'
                background_normal: 'assets/images/new_game/exit.png'
                background_down: 'assets/images/new_game/exit.png'
                on_release: app.exit(self)

<NewGameScreen>:
    name: 'new_game'
    canvas:
        Color:
            rgba: utils.get_color_from_hex('#fbf8ef')
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        spacing: 10
        Label:
            text: 'COLLECTIONS'
            size_hint_y: None
            height: 50
        ScrollView:
            BoxLayout:
                id: collection_grid
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height
                spacing: 10

        Button:
            text: 'Back'
            size_hint_y: None
            height: 50
            on_release: app.back_to_main(self)

<LevelScreen>:
    name: 'levels'
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        spacing: 10
        Label:
            text: root.collection_name
            size_hint_y: None
            height: 50
        ScrollView:
            BoxLayout:
                orientation: 'vertical'
                size_hint_y: None
                height: self.minimum_height
                spacing: 10

                GridLayout:
                    id: level_grid
                    cols: 4
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: 10
        Button:
            text: 'Back'
            size_hint_y: None
            height: 50
            on_release: app.back_to_new_game(self)
<GameScreen>:
    name: 'game'
    canvas:
        Color:
            rgba: utils.get_color_from_hex('#fbf8ef')
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 0
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y : 0.15
            Label:
                text: " "
                background_color: 0, 0, 0, 0
        BoxLayout:
            orientation: 'horizontal'
            spacing:10
            padding:[0,10]
            size_hint_y : 0.12
            BoxLayout:
                orientation: 'vertical'
                size_hint_x : 0.5
                Label:
                    text:'Level '+ root.level_name 
                    color : 0.435, 0.4, 0.361, 1
                    font_name : 'clearsans'
                    font_size: 50
                    markup: True
                    halign :'left'
                    valign : "middle"
                Label:
                    text:root.collection_name 
                    color : 0.435, 0.4, 0.361, 1
                    font_name : 'clearsans'
                    font_size: 18
                    markup: True
                    halign :'left'
                    valign : "middle"
            BoxLayout:
                orientation: 'vertical'
                size_hint_x : 0.25
                Label:
                    text:'MOVES' 
                    size_hint_y: 0.3
                    font_name : 'clearsans'
                    color : 0.98, 0.984, 0.98,1
                    font_size: 12
                    font_name : 'clearsans'
                    canvas.before:
                        Color:
                            rgba: 0.733, 0.678, 0.624,1
                        RoundedRectangle:
                            pos: self.pos
                            size: self.size
                            radius:[(7, 7), (7, 7), (0, 0), (0, 0)]
                Label:
                    id: moves_label
                    text:"{}".format(root.moves)
                    color : 0.98, 0.984, 0.98,1
                    font_size: 40
                    font_name : 'clearsans'
                    canvas.before:
                        Color:
                            rgba: 0.733, 0.678, 0.624,1
                        RoundedRectangle:
                            pos: self.pos
                            size: self.size
                            radius:[(0, 0), (0, 0),(7, 7), (7, 7)]
            BoxLayout:
                orientation: 'vertical'
                size_hint_x : 0.25
                Label:
                    text:'PUSHES' 
                    size_hint_y: 0.3
                    color : 0.98, 0.984, 0.98,1
                    font_size: 12
                    font_name : 'clearsans'
                    canvas.before:
                        Color:
                            rgba: 0.733, 0.678, 0.624,1
                        RoundedRectangle:
                            pos: self.pos
                            size: self.size
                            radius:[(7, 7), (7, 7), (0, 0), (0, 0)]
                Label:
                    id: pushes_label
                    text:"{}".format(root.pushes)
                    color : 0.98, 0.984, 0.98,1
                    font_size: 40
                    font_name : 'clearsans'
                    canvas.before:
                        Color:
                            rgba: 0.733, 0.678, 0.624,1
                        RoundedRectangle:
                            pos: self.pos
                            size: self.size
                            radius:[(0, 0), (0, 0),(7, 7), (7, 7)]
        AnchorLayout:
            canvas.before:
                Color:
                    rgba: 0.733, 0.678, 0.624,1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius:[(7, 7), (7, 7),(7, 7), (7, 7)]
            padding: 10
            anchor_x: 'center'
            anchor_y: 'center'
            size_hint_y :0.45
            GridLayout:
                id :game_grid
                cols :1
                spacing:0
            
        GridLayout:
            cols :7
            padding: [0,10]
            size_hint_y :0.23
            Button:
                text :'Up'
                on_press: root.game.move(0,-1, True)
            Button:
                text:'Left'
                on_press: root.game.move(-1,0, True)
            Button
                text:'Right'
                on_press: root.game.move(1,0, True)
            Button:
                text:'Down'
                on_press: root.game.move(0,1, True)
            Button
                text:'Undo'
                on_press:x: root.game.unmove()
            Button:
                text:'Reset'
                on_press: root.game.reset()
            Button:
                text:'Back'
                on_press:app.back_to_show_levels()
            